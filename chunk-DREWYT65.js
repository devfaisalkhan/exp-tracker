import{a as u,b as E}from"./chunk-VSDMO5SJ.js";import{U as x,Y as c,a as o,b as p,l as d}from"./chunk-I6MSPIIX.js";var i=class{static KEY_BUDGETS="budgets";static KEY_EXPENSES="expenses";static KEY_INCOME="monthlyIncome";static KEY_API_STORAGE="gemini_api_key"};var l=class a{constructor(e,t){this.toastService=e;this.storageService=t;this.loadExpenses()}expensesSubject=new d([]);expenses$=this.expensesSubject.asObservable();loadExpenses(){let e=this.storageService.getItem(i.KEY_EXPENSES);if(e){let t=e.map(s=>p(o({},s),{date:new Date(s.date),createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)}));this.expensesSubject.next(t)}else this.expensesSubject.next([])}saveExpenses(e){this.storageService.setItem(i.KEY_EXPENSES,e),this.expensesSubject.next(e)}getExpenses(){return this.expensesSubject.value}addExpense(e){let t=this.getExpenses(),s=new Date,n=p(o({},e),{id:t.length>0?Math.max(...t.map(m=>m.id))+1:1,date:new Date(e.date),createdAt:s,updatedAt:s}),r=[...t,n];return this.saveExpenses(r),n}updateExpense(e){let t=this.getExpenses(),s=t.findIndex(n=>n.id===e.id);if(s!==-1){let n=new Date,r=[...t];return r[s]=p(o({},e),{updatedAt:n}),this.saveExpenses(r),this.toastService.success("Expense updated successfully!"),!0}return this.toastService.error("Failed to update expense!"),!1}deleteExpense(e){let t=this.getExpenses(),s=t.findIndex(n=>n.id===e);if(s!==-1){let n=[...t];return n.splice(s,1),this.saveExpenses(n),!0}return!1}getMonthlyExpenses(e,t){return this.getExpenses().filter(n=>{let r=new Date(n.date);return r.getFullYear()===e&&r.getMonth()+1===t})}getMonthlySpent(e,t){return this.getMonthlyExpenses(e,t).reduce((n,r)=>n+r.amount,0)}static \u0275fac=function(t){return new(t||a)(c(u),c(E))};static \u0275prov=x({token:a,factory:a.\u0275fac,providedIn:"root"})};export{i as a,l as b};
