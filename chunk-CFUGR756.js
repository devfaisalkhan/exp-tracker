import{a as v}from"./chunk-CZV4CW5C.js";import{a as d,b as S}from"./chunk-ZG5GLZP6.js";import{P as E,T as p,a as r,b as i}from"./chunk-SNEZJZPV.js";var f=class a{constructor(e,t){this.toastService=e;this.incomeService=t}loadExpenses(){let e=localStorage.getItem(d.KEY_EXPENSES);return e?JSON.parse(e).map(s=>i(r({},s),{date:new Date(s.date),createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)})):[]}saveExpenses(e){localStorage.setItem(d.KEY_EXPENSES,JSON.stringify(e))}getExpenses(){return this.loadExpenses()}addExpense(e){let t=new Date(e.date),s=t.getFullYear(),n=t.getMonth()+1,c=this.incomeService.getMonthlyIncome(s,n);if(c){let l=this.incomeService.getMonthlySpent(s,n)+e.amount;if(l>c.amount){let h=l-c.amount;this.toastService.warning(`You are exceeding your monthly income by ${h.toFixed(2)} PKR. Expense added as "Over Budget".`)}}let o=this.loadExpenses(),u=new Date,m=i(r({},e),{id:o.length>0?Math.max(...o.map(x=>x.id))+1:1,createdAt:u,updatedAt:u});return o.push(m),this.saveExpenses(o),this.toastService.success("Expense added successfully!"),m}updateExpense(e){let t=this.loadExpenses(),s=t.findIndex(n=>n.id===e.id);if(s!==-1){let n=new Date;return t[s]=i(r({},e),{updatedAt:n}),this.saveExpenses(t),this.toastService.success("Expense updated successfully!"),!0}return this.toastService.error("Failed to update expense!"),!1}deleteExpense(e){let t=this.loadExpenses(),s=t.findIndex(n=>n.id===e);return s!==-1?(t.splice(s,1),this.saveExpenses(t),this.toastService.success("Expense deleted successfully!"),!0):(this.toastService.error("Failed to delete expense!"),!1)}static \u0275fac=function(t){return new(t||a)(p(v),p(S))};static \u0275prov=E({token:a,factory:a.\u0275fac,providedIn:"root"})};export{f as a};
