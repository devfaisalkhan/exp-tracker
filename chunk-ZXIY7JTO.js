import{a as $}from"./chunk-IIL4ITLS.js";import{a as B,b as u,c as M,d as G,f as V,h as R,i as j,j as q,k as K,l as W,n as J,p as L}from"./chunk-AQZCTEBC.js";import{Ea as A,Ia as s,Lb as O,Mb as T,P as E,Rb as k,Ta as m,Ua as n,Va as l,Wa as P,Xa as D,Ya as C,Z as w,Za as x,_ as N,a as p,b as c,cb as f,db as a,fb as I,ta as o,ya as U}from"./chunk-7T257EYH.js";var F=class r{localStorageKey="userProfile";defaultUser={id:1,name:"Default User",email:"user@example.com",currency:"PKR",theme:"light",createdAt:new Date,updatedAt:new Date};constructor(){}loadUser(){let e=localStorage.getItem(this.localStorageKey);if(e){let i=JSON.parse(e);return c(p({},i),{createdAt:new Date(i.createdAt),updatedAt:new Date(i.updatedAt)})}return null}saveUser(e){localStorage.setItem(this.localStorageKey,JSON.stringify(e))}getUser(){return this.loadUser()||this.defaultUser}updateUser(e){let i=this.getUser(),t=c(p(p({},i),e),{updatedAt:new Date});return this.saveUser(t),t}setUser(e){this.saveUser(e)}static \u0275fac=function(i){return new(i||r)};static \u0275prov=E({token:r,factory:r.\u0275fac,providedIn:"root"})};function X(r,e){if(r&1){let i=D();n(0,"div",21)(1,"div",22)(2,"div",23)(3,"div",5)(4,"div",24)(5,"div")(6,"h5",25),a(7,"Install App"),l(),n(8,"p",26),a(9,"Add Expense Tracker to your home screen for quick access and offline functionality."),l()(),n(10,"button",27),C("click",function(){w(i);let d=x();return N(d.installPWA())}),P(11,"i",28),a(12," Install "),l()()()()()()}}function Y(r,e){r&1&&(n(0,"div",29),a(1," Name is required (minimum 2 characters) "),l())}function Z(r,e){r&1&&(n(0,"div",29),a(1," Please enter a valid email address "),l())}function ee(r,e){if(r&1&&(n(0,"option",30),a(1),l()),r&2){let i=e.$implicit;m("value",i.value),o(),I(" ",i.label," ")}}function te(r,e){r&1&&(n(0,"div",29),a(1," Please select a currency "),l())}function ie(r,e){if(r&1&&(n(0,"option",30),a(1),l()),r&2){let i=e.$implicit;m("value",i.value),o(),I(" ",i.label," ")}}function re(r,e){r&1&&(n(0,"div",29),a(1," Please select a theme "),l())}var z=class r{constructor(e,i,t){this.fb=e;this.userService=i;this.pwaService=t}profileForm;user=null;themes=[{value:"light",label:"Light"},{value:"dark",label:"Dark"}];currencies=[{value:"PKR",label:"Pakistani Rupee (PKR)"},{value:"USD",label:"US Dollar (USD)"},{value:"EUR",label:"Euro (EUR)"},{value:"GBP",label:"British Pound (GBP)"}];showInstallButton=!1;ngOnInit(){this.user=this.userService.getUser(),this.initForm(),this.showInstallButton=this.pwaService.canInstall(),console.log("Profile component - show install button:",this.showInstallButton)}initForm(){this.user&&(this.profileForm=this.fb.group({name:[this.user.name,[u.required,u.minLength(2)]],email:[this.user.email,[u.required,u.email]],currency:[this.user.currency,[u.required]],theme:[this.user.theme,[u.required]]}))}onSubmit(){if(this.profileForm.valid&&this.user){let e=this.profileForm.value,i=c(p({},this.user),{name:e.name,email:e.email,currency:e.currency,theme:e.theme});this.userService.updateUser(i),this.user=i,alert("Profile updated successfully!")}}installPWA(){console.log("Manual install triggered from profile"),this.pwaService.showInstallPrompt()}static \u0275fac=function(i){return new(i||r)(U(J),U(F),U($))};static \u0275cmp=A({type:r,selectors:[["app-user-profile"]],decls:34,vars:17,consts:[[1,"container","mt-4"],["class","row mb-4",4,"ngIf"],[1,"row"],[1,"col-md-6","offset-md-3"],[1,"card"],[1,"card-body"],["novalidate","",1,"needs-validation",3,"ngSubmit","formGroup"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name","placeholder","Enter your full name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email","placeholder","Enter your email",1,"form-control"],["for","currency",1,"form-label"],["id","currency","formControlName","currency",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"mb-4"],["for","theme",1,"form-label"],["id","theme","formControlName","theme",1,"form-select"],[1,"d-grid"],["type","submit",1,"btn","btn-primary","btn-lg",3,"disabled"],[1,"row","mb-4"],[1,"col-12"],[1,"card","border-primary"],[1,"d-flex","justify-content-between","align-items-center"],[1,"card-title","text-primary"],[1,"card-text","mb-0"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-download","me-1"],[1,"invalid-feedback"],[3,"value"]],template:function(i,t){if(i&1&&(n(0,"div",0)(1,"h2"),a(2,"User Profile"),l(),s(3,X,13,0,"div",1),n(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"form",6),C("ngSubmit",function(){return t.onSubmit()}),n(9,"div",7)(10,"label",8),a(11,"Full Name"),l(),P(12,"input",9),s(13,Y,2,0,"div",10),l(),n(14,"div",7)(15,"label",11),a(16,"Email Address"),l(),P(17,"input",12),s(18,Z,2,0,"div",10),l(),n(19,"div",7)(20,"label",13),a(21,"Preferred Currency"),l(),n(22,"select",14),s(23,ee,2,2,"option",15),l(),s(24,te,2,0,"div",10),l(),n(25,"div",16)(26,"label",17),a(27,"Theme"),l(),n(28,"select",18),s(29,ie,2,2,"option",15),l(),s(30,re,2,0,"div",10),l(),n(31,"div",19)(32,"button",20),a(33," Update Profile "),l()()()()()()()()),i&2){let d,v,h,g,b,_,y,S;o(3),m("ngIf",t.showInstallButton),o(5),m("formGroup",t.profileForm),o(4),f("is-invalid",((d=t.profileForm.get("name"))==null?null:d.invalid)&&((d=t.profileForm.get("name"))==null?null:d.touched)),o(),m("ngIf",((v=t.profileForm.get("name"))==null?null:v.invalid)&&((v=t.profileForm.get("name"))==null?null:v.touched)),o(4),f("is-invalid",((h=t.profileForm.get("email"))==null?null:h.invalid)&&((h=t.profileForm.get("email"))==null?null:h.touched)),o(),m("ngIf",((g=t.profileForm.get("email"))==null?null:g.invalid)&&((g=t.profileForm.get("email"))==null?null:g.touched)),o(4),f("is-invalid",((b=t.profileForm.get("currency"))==null?null:b.invalid)&&((b=t.profileForm.get("currency"))==null?null:b.touched)),o(),m("ngForOf",t.currencies),o(),m("ngIf",((_=t.profileForm.get("currency"))==null?null:_.invalid)&&((_=t.profileForm.get("currency"))==null?null:_.touched)),o(4),f("is-invalid",((y=t.profileForm.get("theme"))==null?null:y.invalid)&&((y=t.profileForm.get("theme"))==null?null:y.touched)),o(),m("ngForOf",t.themes),o(),m("ngIf",((S=t.profileForm.get("theme"))==null?null:S.invalid)&&((S=t.profileForm.get("theme"))==null?null:S.touched)),o(2),m("disabled",t.profileForm.invalid)}},dependencies:[k,O,T,L,V,K,W,B,q,M,G,R,j],styles:[".card[_ngcontent-%COMP%]{box-shadow:0 4px 6px #0000001a;border:none}.card-body[_ngcontent-%COMP%]{padding:2rem}.form-label[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{font-weight:600}"]})};export{z as UserProfileComponent};
