import{a as L,b as $,c as W,d as Y,e as U,f as z,g as H,h as J,i as Q,j as X,k as Z,l as ee,m as te}from"./chunk-SWTJJGWB.js";import{a as ve}from"./chunk-BLONM6LW.js";import{a as ae,b as g,c as oe,d as de,f as le,g as se,h as me,i as ce,j as ge,k as pe,l as ue,m as be,n as fe,p as he}from"./chunk-CQQBNYNJ.js";import{a as D,b as re}from"./chunk-YILLF26G.js";import{a as ne,b as ie}from"./chunk-VNNQ3FS5.js";import{$a as M,$b as K,Ca as y,Ia as I,Ma as x,Sb as R,T as _,Tb as j,Ub as V,X as w,Xa as m,Xb as G,Ya as r,Za as n,Zb as q,_a as s,a as b,ab as B,b as f,bb as F,ca as P,da as O,jb as A,kb as E,lb as a,mb as S,nb as p,ob as k,ub as T,vb as c,wb as N,xa as o,xb as u}from"./chunk-FMDOM5OR.js";var C=class d{constructor(i,e){this.toastService=i;this.storageService=e}loadBudgets(){let i=this.storageService.getItem(D.KEY_BUDGETS);return i?i.map(t=>f(b({},t),{startDate:new Date(t.startDate),endDate:t.endDate?new Date(t.endDate):void 0,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)})):[]}saveBudgets(i){this.storageService.setItem(D.KEY_BUDGETS,i)}getBudgets(){return this.loadBudgets()}getBudgetByCategory(i){return this.loadBudgets().find(t=>t.categoryId===i&&(!t.endDate||new Date(t.endDate)>=new Date))}addBudget(i){let e=this.loadBudgets(),t=f(b({},i),{id:e.length>0?Math.max(...e.map(l=>l.id))+1:1,createdAt:new Date,updatedAt:new Date});return e.push(t),this.saveBudgets(e),this.toastService.success("Budget created successfully!"),t}updateBudget(i){let e=this.loadBudgets(),t=e.findIndex(l=>l.id===i.id);return t!==-1?(e[t]=f(b({},i),{updatedAt:new Date}),this.saveBudgets(e),this.toastService.success("Budget updated successfully!"),!0):(this.toastService.error("Failed to update budget!"),!1)}deleteBudget(i){let e=this.loadBudgets(),t=e.findIndex(l=>l.id===i);return t!==-1?(e.splice(t,1),this.saveBudgets(e),this.toastService.success("Budget deleted successfully!"),!0):(this.toastService.error("Failed to delete budget!"),!1)}static \u0275fac=function(e){return new(e||d)(w(ne),w(ie))};static \u0275prov=_({token:d,factory:d.\u0275fac,providedIn:"root"})};var Ee=(d,i,e)=>({"bg-gradient-success":d,"bg-gradient-warning":i,"bg-gradient-danger":e});function De(d,i){d&1&&(r(0,"div",61),a(1," Required (min 3 chars) "),n())}function _e(d,i){if(d&1&&(r(0,"option",62),a(1),n()),d&2){let e=i.$implicit;m("value",e),o(),p("",e," ")}}function Pe(d,i){if(d&1&&(r(0,"option",62),a(1),n()),d&2){let e=i.$implicit;m("value",e.value),o(),p("",e.label," ")}}function Oe(d,i){d&1&&(r(0,"tr")(1,"td",63),a(2," No budgets created yet. Create your first budget above. "),n()())}function Ie(d,i){if(d&1){let e=M();r(0,"tr",64)(1,"td",65)(2,"div",26),a(3),n(),r(4,"small",66),a(5),c(6,"titlecase"),n()(),r(7,"td",67)(8,"span",68),a(9),n()(),r(10,"td",69)(11,"div",70)(12,"span",66),a(13),c(14,"number"),c(15,"number"),n(),r(16,"span"),a(17),c(18,"number"),n()(),r(19,"div",71),s(20,"div",72),n()(),r(21,"td",73)(22,"button",74),B("click",function(){let l=P(e).$implicit,h=F();return O(h.deleteBudget(l.id))}),s(23,"i",75),n()()()}if(d&2){let e=i.$implicit;o(3),S(e.name),o(2),S(N(6,13,e.period)),o(4),S(e.categoryId),o(4),k("",u(14,15,e.currentSpent,"1.0-0")," / ",u(15,18,e.amount,"1.0-0")),o(3),E("text-danger",e.remainingAmount<0)("text-success",e.remainingAmount>=0),o(),p(" ",u(18,21,e.remainingAmount,"1.0-0")," left "),o(3),A("width",e.spentPercentage,"%"),m("ngClass",T(24,Ee,e.spentPercentage<80,e.spentPercentage>=80&&e.spentPercentage<=100,e.spentPercentage>100))}}Y.register(W,L,$,Z,ee,H,z,Q,X,J,U);var xe=class d{constructor(i,e,t){this.fb=i;this.budgetService=e;this.expenseService=t}budgetForm;budgets=[];expenseCategories=Object.values(ve);periods=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"}];totalBudgets=0;totalAllocated=0;totalSpent=0;totalRemaining=0;budgetChartType="doughnut";budgetChartData={labels:[],datasets:[{data:[],backgroundColor:["#6366f1","#8b5cf6","#d946ef","#ec4899","#f43f5e","#f97316","#eab308","#84cc16","#10b981","#06b6d4","#3b82f6","#64748b"],borderWidth:0,hoverOffset:4}]};chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8",font:{family:"Inter"}}}}};ngOnInit(){this.initForm(),this.loadBudgets()}initForm(){this.budgetForm=this.fb.group({name:["",[g.required,g.minLength(3)]],categoryId:["",[g.required]],amount:["",[g.required,g.min(.01)]],period:["monthly",[g.required]],startDate:[this.getTodayString(),[g.required]]})}getTodayString(){return new Date().toISOString().split("T")[0]}loadBudgets(){let i=this.budgetService.getBudgets(),e=this.expenseService.getExpenses();this.budgets=i.map(t=>{let h=e.filter(v=>v.category===t.categoryId&&new Date(v.date)>=new Date(t.startDate)&&(!t.endDate||new Date(v.date)<=new Date(t.endDate))).reduce((v,Ce)=>v+Ce.amount,0),Se=t.amount>0?h/t.amount*100:0,ye=t.amount-h;return f(b({},t),{currentSpent:h,spentPercentage:Se,remainingAmount:ye})}),this.updateBudgetChart()}updateBudgetChart(){let i=this.budgets.filter(e=>e.currentSpent>0||e.amount>0);i.length>0?(this.budgetChartData.labels=i.map(e=>`${e.name} (${e.categoryId})`),this.budgetChartData.datasets[0].data=i.map(e=>e.currentSpent)):(this.budgetChartData.labels=["No budget data"],this.budgetChartData.datasets[0].data=[1]),this.totalBudgets=this.budgets.length,this.totalAllocated=this.budgets.reduce((e,t)=>e+t.amount,0),this.totalSpent=this.budgets.reduce((e,t)=>e+t.currentSpent,0),this.totalRemaining=this.budgets.reduce((e,t)=>e+t.remainingAmount,0)}onSubmit(){if(this.budgetForm.valid){let i=this.budgetForm.value,e={name:i.name,categoryId:i.categoryId,amount:i.amount,period:i.period,startDate:new Date(i.startDate),endDate:this.calculateEndDate(i.startDate,i.period),currentSpent:0};this.budgetService.addBudget(e),this.budgetForm.reset({name:"",categoryId:"",amount:"",period:"monthly",startDate:this.getTodayString()}),this.loadBudgets()}}calculateEndDate(i,e){let t=new Date(i),l=new Date(t);switch(e){case"daily":l.setDate(t.getDate()+1);break;case"weekly":l.setDate(t.getDate()+7);break;case"monthly":l.setMonth(t.getMonth()+1);break;case"yearly":l.setFullYear(t.getFullYear()+1);break;default:l.setMonth(t.getMonth()+1);break}return l}deleteBudget(i){confirm("Are you sure you want to delete this budget?")&&this.budgetService.deleteBudget(i)&&this.loadBudgets()}getBudgetStatusClass(i){return i.spentPercentage>=100?"bg-danger":i.spentPercentage>=80?"bg-warning":"bg-success"}static \u0275fac=function(e){return new(e||d)(y(fe),y(C),y(re))};static \u0275cmp=I({type:d,selectors:[["app-budgets"]],decls:117,vars:27,consts:[[1,"container-fluid","dashboard-container"],[1,"d-flex","align-items-center","mb-4"],["routerLink","/dashboard",1,"btn","btn-icon","btn-sm","me-3","text-white"],[1,"bi","bi-arrow-left","fs-4"],[1,"mb-0","fw-bold","text-gradient"],[1,"text-secondary","mb-0","small"],[1,"row","justify-content-center","mb-4"],[1,"col-12","col-lg-8"],[1,"glass-card","p-4"],[1,"text-white","mb-4"],["novalidate","",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6","mb-4"],["for","name",1,"form-label","text-secondary","small","fw-bold","text-uppercase"],[1,"input-group"],[1,"input-group-text","bg-transparent","border-end-0","text-accent","border-white-10"],[1,"bi","bi-pencil"],["type","text","id","name","formControlName","name","placeholder","e.g., Monthly Grocery",1,"form-control","bg-transparent","text-white","border-start-0","ps-0","border-white-10"],["class","text-danger small mt-1",4,"ngIf"],["for","categoryId",1,"form-label","text-secondary","small","fw-bold","text-uppercase"],[1,"bi","bi-tag"],["id","categoryId","formControlName","categoryId",1,"form-select","bg-transparent","text-white","border-start-0","ps-0","border-white-10"],["value","","disabled","","selected",""],["class","text-dark",3,"value",4,"ngFor","ngForOf"],[1,"col-md-4","mb-4"],["for","amount",1,"form-label","text-secondary","small","fw-bold","text-uppercase"],[1,"fw-bold"],["type","number","id","amount","formControlName","amount","min","0.01","step","0.01","placeholder","0.00",1,"form-control","bg-transparent","text-white","border-start-0","ps-0","border-white-10"],["for","period",1,"form-label","text-secondary","small","fw-bold","text-uppercase"],[1,"bi","bi-calendar-range"],["id","period","formControlName","period",1,"form-select","bg-transparent","text-white","border-start-0","ps-0","border-white-10"],["for","startDate",1,"form-label","text-secondary","small","fw-bold","text-uppercase"],[1,"bi","bi-calendar-event"],["type","date","id","startDate","formControlName","startDate",1,"form-control","bg-transparent","text-white","border-start-0","ps-0","border-white-10"],[1,"d-grid"],["type","submit",1,"btn","btn-primary-gradient","btn-lg","rounded-pill","py-3","fw-bold",3,"disabled"],[1,"bi","bi-plus-circle","me-2"],[1,"row","mb-4"],[1,"col-12"],[1,"row","align-items-center"],[1,"col-md-8","mb-4","mb-md-0"],[1,"chart-container",2,"height","300px"],["baseChart","",3,"data","options","type"],[1,"col-md-4"],[1,"p-4","rounded-3","bg-white-5"],[1,"text-white","mb-3"],[1,"mb-3"],[1,"text-secondary","d-block"],[1,"text-white","fw-bold","fs-5"],[1,"text-danger","fw-bold","fs-5"],[1,"fw-bold","fs-5"],[1,"glass-card","p-0","overflow-hidden"],[1,"p-4","border-bottom","border-white-10"],[1,"text-white","mb-0"],[1,"table-responsive"],[1,"table","text-white","mb-0"],[1,"border-bottom","border-white-10","text-secondary","small","fw-bold","text-uppercase","ps-4"],[1,"border-bottom","border-white-10","text-secondary","small","fw-bold","text-uppercase"],[1,"border-bottom","border-white-10","text-secondary","small","fw-bold","text-uppercase","text-end","pe-4"],[4,"ngIf"],["class","align-middle",4,"ngFor","ngForOf"],[1,"text-danger","small","mt-1"],[1,"text-dark",3,"value"],["colspan","4",1,"text-center","py-5","text-secondary"],[1,"align-middle"],[1,"ps-4","border-bottom","border-white-10"],[1,"text-secondary"],[1,"border-bottom","border-white-10"],[1,"badge","bg-white-10","text-white","fw-normal"],[1,"border-bottom","border-white-10",2,"min-width","200px"],[1,"d-flex","justify-content-between","mb-1","small"],[1,"progress","bg-dark",2,"height","6px"],["role","progressbar",1,"progress-bar",3,"ngClass"],[1,"text-end","pe-4","border-bottom","border-white-10"],["title","Delete",1,"btn","btn-icon","btn-sm","text-danger","bg-white-5",3,"click"],[1,"bi","bi-trash"]],template:function(e,t){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"a",2),s(3,"i",3),n(),r(4,"div")(5,"h2",4),a(6,"Budget Management"),n(),r(7,"p",5),a(8,"Set and track your spending limits"),n()()(),r(9,"div",6)(10,"div",7)(11,"div",8)(12,"h5",9),a(13,"Create New Budget"),n(),r(14,"form",10),B("ngSubmit",function(){return t.onSubmit()}),r(15,"div",11)(16,"div",12)(17,"label",13),a(18,"Budget Name"),n(),r(19,"div",14)(20,"span",15),s(21,"i",16),n(),s(22,"input",17),n(),x(23,De,2,0,"div",18),n(),r(24,"div",12)(25,"label",19),a(26,"Category"),n(),r(27,"div",14)(28,"span",15),s(29,"i",20),n(),r(30,"select",21)(31,"option",22),a(32,"Select Category"),n(),x(33,_e,2,2,"option",23),n()()()(),r(34,"div",11)(35,"div",24)(36,"label",25),a(37,"Amount"),n(),r(38,"div",14)(39,"span",15)(40,"span",26),a(41,"PKR"),n()(),s(42,"input",27),n()(),r(43,"div",24)(44,"label",28),a(45,"Period"),n(),r(46,"div",14)(47,"span",15),s(48,"i",29),n(),r(49,"select",30),x(50,Pe,2,2,"option",23),n()()(),r(51,"div",24)(52,"label",31),a(53,"Start Date"),n(),r(54,"div",14)(55,"span",15),s(56,"i",32),n(),s(57,"input",33),n()()(),r(58,"div",34)(59,"button",35),s(60,"i",36),a(61,"Create Budget "),n()()()()()(),r(62,"div",37)(63,"div",38)(64,"div",8)(65,"div",39)(66,"div",40)(67,"h5",9),a(68,"Budget Overview"),n(),r(69,"div",41),s(70,"canvas",42),n()(),r(71,"div",43)(72,"div",44)(73,"h6",45),a(74,"Summary"),n(),r(75,"div",46)(76,"small",47),a(77,"Total Budgets"),n(),r(78,"span",48),a(79),n()(),r(80,"div",46)(81,"small",47),a(82,"Total Allocated"),n(),r(83,"span",48),a(84),c(85,"number"),n()(),r(86,"div",46)(87,"small",47),a(88,"Total Spent"),n(),r(89,"span",49),a(90),c(91,"number"),n()(),r(92,"div")(93,"small",47),a(94,"Remaining"),n(),r(95,"span",50),a(96),c(97,"number"),n()()()()()()()(),r(98,"div",51)(99,"div",52)(100,"h5",53),a(101,"Active Budgets"),n()(),r(102,"div",54)(103,"table",55)(104,"thead")(105,"tr")(106,"th",56),a(107,"Name"),n(),r(108,"th",57),a(109,"Category"),n(),r(110,"th",57),a(111,"Progress"),n(),r(112,"th",58),a(113,"Actions "),n()()(),r(114,"tbody"),x(115,Oe,3,0,"tr",59)(116,Ie,24,28,"tr",60),n()()()()()),e&2){let l;o(14),m("formGroup",t.budgetForm),o(9),m("ngIf",((l=t.budgetForm.get("name"))==null?null:l.invalid)&&((l=t.budgetForm.get("name"))==null?null:l.touched)),o(10),m("ngForOf",t.expenseCategories),o(17),m("ngForOf",t.periods),o(9),m("disabled",t.budgetForm.invalid),o(11),m("data",t.budgetChartData)("options",t.chartOptions)("type",t.budgetChartType),o(9),S(t.totalBudgets),o(5),p("PKR ",u(85,18,t.totalAllocated,"1.0-0")),o(6),p("PKR ",u(91,21,t.totalSpent,"1.0-0")),o(5),E("text-success",t.totalRemaining>=0)("text-danger",t.totalRemaining<0),o(),p(" PKR ",u(97,24,t.totalRemaining,"1.0-0")," "),o(19),m("ngIf",t.budgets.length===0),o(),m("ngForOf",t.budgets)}},dependencies:[K,R,j,V,he,le,pe,ue,ae,se,ge,oe,de,be,me,ce,te,q,G],styles:[".form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.1);color:#fff}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{background:#ffffff1a;border-color:var(--text-accent);box-shadow:0 0 0 4px #6366f11a;color:#fff}.form-control[_ngcontent-%COMP%]::placeholder, .form-select[_ngcontent-%COMP%]::placeholder{color:#ffffff4d}.input-group-text[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.1);border-right:none}.form-control[_ngcontent-%COMP%]:focus + .input-group-text[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]:focus ~ .input-group-text[_ngcontent-%COMP%]{border-color:var(--text-accent)}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:#1e293b;color:#fff;padding:10px}.btn-icon[_ngcontent-%COMP%]{width:32px;height:32px;display:inline-flex;align-items:center;justify-content:center;border-radius:50%;background:#ffffff0d;transition:all .2s;border:none}.btn-icon[_ngcontent-%COMP%]:hover{background:#dc354533;color:#ff6b6b!important}.bg-white-5[_ngcontent-%COMP%]{background:#ffffff0d}.bg-white-10[_ngcontent-%COMP%]{background:#ffffff1a}.border-white-10[_ngcontent-%COMP%]{border-color:#ffffff1a!important}.text-accent[_ngcontent-%COMP%]{color:var(--text-accent)!important}.bg-gradient-success[_ngcontent-%COMP%]{background:linear-gradient(90deg,#10b981,#34d399)}.bg-gradient-warning[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f59e0b,#fbbf24)}.bg-gradient-danger[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ef4444,#f87171)}.table[_ngcontent-%COMP%]{--bs-table-bg: transparent;--bs-table-color: white;--bs-table-hover-bg: rgba(255, 255, 255, .05);--bs-table-hover-color: white}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{background-color:transparent;color:inherit}"]})};export{xe as BudgetsComponent};
