import{a as d,b as I}from"./chunk-YILLF26G.js";import{b as p}from"./chunk-VNNQ3FS5.js";import{T as h,X as l,a,b as u}from"./chunk-FMDOM5OR.js";var y=class m{constructor(e,t){this.storageService=e;this.expenseService=t}loadMonthlyIncome(){let e=this.storageService.getItem(d.KEY_INCOME);return e?e.map(n=>u(a({},n),{createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)})):[]}saveMonthlyIncome(e){this.storageService.setItem(d.KEY_INCOME,e)}getMonthlyIncome(e,t){let n=this.loadMonthlyIncome(),o=`${e}-${t.toString().padStart(2,"0")}`;return n.find(r=>r.id===o)}setMonthlyIncome(e,t,n){let o=this.loadMonthlyIncome(),r=`${e}-${t.toString().padStart(2,"0")}`,c=new Date,i=o.findIndex(s=>s.id===r);if(i!==-1)o[i]=u(a({},o[i]),{amount:n,updatedAt:c});else{let s={id:r,amount:n,currency:"PKR",createdAt:c,updatedAt:c};o.push(s)}return this.saveMonthlyIncome(o),o[i!==-1?i:o.length-1]}deleteMonthlyIncome(e,t){let n=this.loadMonthlyIncome(),o=`${e}-${t.toString().padStart(2,"0")}`,r=n.findIndex(c=>c.id===o);return r!==-1?(n.splice(r,1),this.saveMonthlyIncome(n),!0):!1}getAllMonthlyIncomes(){return this.loadMonthlyIncome()}formatMonthKey(e,t){return`${e}-${t.toString().padStart(2,"0")}`}getRemainingBudget(e,t){let n=this.getMonthlyIncome(e,t);if(!n)return 0;let o=this.expenseService.getMonthlySpent(e,t);return n.amount-o}getPercentageUsed(e,t){let n=this.getMonthlyIncome(e,t);if(!n||n.amount===0)return 0;let o=this.expenseService.getMonthlySpent(e,t);return Math.min(100,o/n.amount*100)}isOverBudget(e,t){return this.getRemainingBudget(e,t)<0}wouldExceedBudget(e,t,n){let o=this.getMonthlyIncome(e,t);if(!o)return{exceeds:!1,excessAmount:0};let c=this.expenseService.getMonthlySpent(e,t)+n,i=c-o.amount;return{exceeds:c>o.amount,excessAmount:Math.max(0,i)}}static \u0275fac=function(t){return new(t||m)(l(p),l(I))};static \u0275prov=h({token:m,factory:m.\u0275fac,providedIn:"root"})};export{y as a};
