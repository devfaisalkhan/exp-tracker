<div class="container-fluid dashboard-container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="mb-0 fw-bold text-gradient">Expenses</h2>
      <p class="text-secondary mb-0 small">Track and manage your spending</p>
    </div>
    <span class="badge bg-white-10 text-white rounded-pill px-3 py-2">{{ filteredExpenses.length }} items</span>
  </div>

  <!-- Filter Section -->
  <div class="glass-card mb-4 p-3">
    <div class="row g-3">
      <div class="col-6 col-md-3">
        <label for="categoryFilter" class="form-label text-secondary small fw-bold text-uppercase">Category</label>
        <select id="categoryFilter" class="form-select form-select-sm bg-transparent text-white border-white-10"
          [(ngModel)]="selectedCategory" (ngModelChange)="onFilterChange()">
          <option value="" class="text-dark">All Categories</option>
          <option *ngFor="let category of categories" [value]="category" class="text-dark">{{ category }}</option>
        </select>
      </div>

      <div class="col-6 col-md-3">
        <label for="paymentMethodFilter" class="form-label text-secondary small fw-bold text-uppercase">Payment</label>
        <select id="paymentMethodFilter" class="form-select form-select-sm bg-transparent text-white border-white-10"
          [(ngModel)]="paymentMethodFilter" (ngModelChange)="onFilterChange()">
          <option value="" class="text-dark">All Methods</option>
          <option *ngFor="let method of getUniquePaymentMethods()" [value]="method" class="text-dark">{{ method }}
          </option>
        </select>
      </div>

      <div class="col-6 col-md-3">
        <label for="startDate" class="form-label text-secondary small fw-bold text-uppercase">From</label>
        <input type="date" id="startDate" class="form-control form-control-sm bg-transparent text-white border-white-10"
          [(ngModel)]="startDate" (ngModelChange)="onFilterChange()">
      </div>

      <div class="col-6 col-md-3">
        <label for="endDate" class="form-label text-secondary small fw-bold text-uppercase">To</label>
        <input type="date" id="endDate" class="form-control form-control-sm bg-transparent text-white border-white-10"
          [(ngModel)]="endDate" (ngModelChange)="onFilterChange()">
      </div>

      <div class="col-12 d-flex justify-content-end mt-2"
        *ngIf="selectedCategory || startDate || endDate || paymentMethodFilter">
        <button class="btn btn-sm btn-outline-light rounded-pill px-3" (click)="clearFilters()">
          <i class="bi bi-x-lg me-1"></i> Clear Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Expense List -->
  <div class="glass-card p-0 overflow-hidden">
    <div class="list-group list-group-flush bg-transparent">
      <div class="list-group-item bg-transparent border-bottom border-white-10 px-4 py-3 expense-item"
        *ngFor="let expense of filteredExpenses; let i = index">
        <div class="d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <!-- Category icon -->
            <div class="icon-circle bg-white-5 me-3 text-accent">
              <i class="bi bi-bag"></i>
            </div>

            <div>
              <h6 class="text-white mb-1 fw-medium">{{ expense.title }}</h6>
              <div class="d-flex gap-2 flex-wrap align-items-center">
                <span class="badge bg-white-10 text-secondary fw-normal">{{ expense.category }}</span>
                <small class="text-secondary">â€¢ {{ expense.date | date:'MMM d' }}</small>
                <span *ngIf="expense.paymentMethod"
                  class="badge bg-white-5 text-secondary fw-normal border border-white-10">{{ expense.paymentMethod
                  }}</span>
              </div>
            </div>
          </div>

          <div class="text-end">
            <h6 class="mb-1 text-white fw-bold">- {{ expense.amount | number:'1.0-0' }}</h6>
            <small class="text-secondary">{{ expense.date | date:'shortTime' }}</small>
          </div>
        </div>

        <!-- Notes & Tags -->
        <div class="mt-2 ps-5 ms-2" *ngIf="expense.notes || (expense.tags && expense.tags.length > 0)">
          <div *ngIf="expense.notes" class="text-secondary small mb-1 fst-italic">{{ expense.notes }}</div>
          <div class="d-flex gap-1 flex-wrap" *ngIf="expense.tags && expense.tags.length > 0">
            <span class="text-accent small me-1" *ngFor="let tag of expense.tags">#{{ tag }}</span>
          </div>
        </div>

        <!-- Delete Action (Hover only on desktop, always visible on mobile if needed, but let's keep it simple) -->
        <div class="expense-actions">
          <button class="btn btn-icon btn-sm text-danger bg-white-5" (click)="deleteExpense(expense.id)" title="Delete">
            <i class="bi bi-trash"></i>
          </button>
        </div>
      </div>

      <!-- Empty State -->
      <div class="text-center py-5" *ngIf="filteredExpenses.length === 0">
        <div class="icon-box bg-white-5 mx-auto mb-3 rounded-circle" style="width: 64px; height: 64px;">
          <i class="bi bi-search text-secondary fs-3"></i>
        </div>
        <h5 class="text-white">No expenses found</h5>
        <p class="text-secondary mb-0">Try adjusting your filters or add a new expense</p>
      </div>
    </div>
  </div>
</div>