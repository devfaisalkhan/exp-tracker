import{a as ee}from"./chunk-BLONM6LW.js";import{e as B,i as V}from"./chunk-7HEDUY4R.js";import{a as U,b as u,c as G,d as $,f as K,g as L,h as Y,i as W,j as z,k as H,l as J,m as Q,n as X,p as Z}from"./chunk-CQQBNYNJ.js";import{a as R}from"./chunk-ZV6PZWFY.js";import{b as q}from"./chunk-YILLF26G.js";import{a as j}from"./chunk-VNNQ3FS5.js";import{$a as M,$b as T,Ca as g,Ia as E,Ma as p,Sb as P,Tb as A,Ub as N,Xa as m,Ya as t,Za as e,Zb as k,_a as c,ab as w,bb as h,ca as S,da as _,jb as C,lb as r,mb as I,nb as b,ub as F,vb as O,xa as d,xb as D}from"./chunk-FMDOM5OR.js";var ie=(o,n,i)=>({"bg-gradient-success":o,"bg-gradient-warning":n,"bg-gradient-danger":i});function re(o,n){o&1&&(t(0,"div",7)(1,"div",8),c(2,"i",9),t(3,"div")(4,"h5",10),r(5,"Budget Not Set"),e(),t(6,"p",11),r(7,"Please set your monthly income before adding expenses to track your budget effectively. "),e(),t(8,"a",12),r(9,"Set Income"),e()()()())}function oe(o,n){o&1&&(t(0,"div",54),r(1," Title is required "),e())}function ae(o,n){o&1&&(t(0,"div",54),r(1," Amount is required "),e())}function le(o,n){o&1&&(t(0,"div",54),r(1," Date is required "),e())}function se(o,n){if(o&1&&(t(0,"option",55),r(1),e()),o&2){let i=n.$implicit;m("value",i),d(),b("",i," ")}}function de(o,n){o&1&&(t(0,"div",54),r(1," Please select a category "),e())}function me(o,n){if(o&1&&(t(0,"option",55),r(1),e()),o&2){let i=n.$implicit;m("value",i),d(),I(i)}}function ce(o,n){if(o&1){let i=M();t(0,"div",13)(1,"div",14)(2,"form",15),w("ngSubmit",function(){S(i);let s=h();return _(s.onSubmit())}),t(3,"div",16)(4,"label",17),r(5,"Title"),e(),t(6,"div",18)(7,"span",19),c(8,"i",20),e(),c(9,"input",21),e(),p(10,oe,2,0,"div",22),e(),t(11,"div",23)(12,"div",24)(13,"label",25),r(14,"Amount"),e(),t(15,"div",18)(16,"span",19)(17,"span",26),r(18,"PKR"),e()(),c(19,"input",27),e(),p(20,ae,2,0,"div",22),e(),t(21,"div",24)(22,"label",28),r(23,"Date"),e(),t(24,"div",18)(25,"span",19),c(26,"i",29),e(),c(27,"input",30),e(),p(28,le,2,0,"div",22),e()(),t(29,"div",23)(30,"div",24)(31,"label",31),r(32,"Category"),e(),t(33,"div",18)(34,"span",19),c(35,"i",32),e(),t(36,"select",33)(37,"option",34),r(38,"Select Category"),e(),p(39,se,2,2,"option",35),e()(),p(40,de,2,0,"div",22),e(),t(41,"div",24)(42,"label",36),r(43,"Payment Method"),e(),t(44,"div",18)(45,"span",19),c(46,"i",37),e(),t(47,"select",38)(48,"option",34),r(49,"Select Method"),e(),p(50,me,2,2,"option",35),e()()()(),t(51,"div",16)(52,"label",39),r(53,"Tags"),e(),t(54,"div",18)(55,"span",19),c(56,"i",40),e(),c(57,"input",41),e()(),t(58,"div",42)(59,"label",43),r(60,"Notes"),e(),c(61,"textarea",44),e(),t(62,"div",45)(63,"button",46),r(64," Save Expense "),e()()(),t(65,"div",47)(66,"h6",48),r(67,"Budget Impact"),e(),t(68,"div",49)(69,"span",50),r(70,"Current Remaining:"),e(),t(71,"span",51),r(72),O(73,"number"),e()(),t(74,"div",52),c(75,"div",53),e()()()()}if(o&2){let i,l,s,f,a=h();d(2),m("formGroup",a.expenseForm),d(8),m("ngIf",((i=a.expenseForm.get("title"))==null?null:i.invalid)&&((i=a.expenseForm.get("title"))==null?null:i.touched)),d(10),m("ngIf",((l=a.expenseForm.get("amount"))==null?null:l.invalid)&&((l=a.expenseForm.get("amount"))==null?null:l.touched)),d(8),m("ngIf",((s=a.expenseForm.get("date"))==null?null:s.invalid)&&((s=a.expenseForm.get("date"))==null?null:s.touched)),d(11),m("ngForOf",a.expenseCategories),d(),m("ngIf",((f=a.expenseForm.get("category"))==null?null:f.invalid)&&((f=a.expenseForm.get("category"))==null?null:f.touched)),d(10),m("ngForOf",a.paymentMethods),d(13),m("disabled",a.expenseForm.invalid),d(9),b("PKR ",D(73,12,a.remainingBudget,"1.0-0")),d(3),C("width",a.Math.min(100,a.percentageUsed),"%"),m("ngClass",F(15,ie,a.percentageUsed<80,a.percentageUsed>=80&&a.percentageUsed<=100,a.percentageUsed>100))}}var te=class o{constructor(n,i,l,s){this.fb=n;this.expenseService=i;this.incomeService=l;this.toastService=s}expenseForm;expenseCategories=Object.values(ee);paymentMethods=["Cash","Credit Card","Debit Card","Bank Transfer","Mobile Payment","Other"];defaultDate=new Date;hasMonthlyIncome=!1;currentMonthIncome=0;currentMonthSpent=0;remainingBudget=0;percentageUsed=0;Math=Math;ngOnInit(){this.checkMonthlyIncome(),this.initForm()}checkMonthlyIncome(){let n=new Date,i=n.getFullYear(),l=n.getMonth()+1,s=this.incomeService.getMonthlyIncome(i,l);this.hasMonthlyIncome=!!s,s&&(this.currentMonthIncome=s.amount,this.currentMonthSpent=this.expenseService.getMonthlySpent(i,l),this.remainingBudget=this.incomeService.getRemainingBudget(i,l),this.percentageUsed=this.incomeService.getPercentageUsed(i,l))}initForm(){this.expenseForm=this.fb.group({title:["",[u.required]],amount:["",[u.required,u.min(.01)]],date:[this.formatDateForInput(this.defaultDate),[u.required]],category:["",[u.required]],paymentMethod:[""],notes:[""],tags:[""]})}formatDateForInput(n){let i=n.getFullYear(),l=(n.getMonth()+1).toString().padStart(2,"0"),s=n.getDate().toString().padStart(2,"0");return`${i}-${l}-${s}`}onSubmit(){if(this.expenseForm.valid){let n=this.expenseForm.value,i=n.tags?n.tags.split(",").map(x=>x.trim()).filter(x=>x):[],l={title:n.title,amount:parseFloat(n.amount),date:new Date(n.date),category:n.category,notes:n.notes,paymentMethod:n.paymentMethod,tags:i.length>0?i:void 0},s=new Date(n.date),f=s.getFullYear(),a=s.getMonth()+1,v=this.incomeService.getMonthlyIncome(f,a);if(v){let y=this.expenseService.getMonthlySpent(f,a)+l.amount;if(y>v.amount){let ne=y-v.amount;confirm(`This expense will exceed your monthly income by ${ne.toFixed(2)} PKR. Do you want to add it anyway as "Over Budget"?`)?(this.expenseService.addExpense(l),this.expenseForm.reset({title:"",amount:"",date:this.formatDateForInput(this.defaultDate),category:"",paymentMethod:"",notes:"",tags:""}),this.toastService.warning("Expense added successfully (Over Budget)!"),this.checkMonthlyIncome()):this.toastService.info("Expense not added.")}else this.expenseService.addExpense(l),this.expenseForm.reset({title:"",amount:"",date:this.formatDateForInput(this.defaultDate),category:"",paymentMethod:"",notes:"",tags:""}),this.toastService.success("Expense added successfully!"),this.checkMonthlyIncome()}else this.expenseService.addExpense(l),this.expenseForm.reset({title:"",amount:"",date:this.formatDateForInput(this.defaultDate),category:"",paymentMethod:"",notes:"",tags:""}),this.toastService.success("Expense added successfully!")}else this.toastService.error("Please fill in all required fields correctly.")}static \u0275fac=function(i){return new(i||o)(g(X),g(q),g(R),g(j))};static \u0275cmp=E({type:o,selectors:[["app-add-expense"]],decls:8,vars:2,consts:[[1,"container-fluid","dashboard-container"],[1,"d-flex","align-items-center","mb-4"],["routerLink","/dashboard",1,"btn","btn-icon","btn-sm","me-3","text-white"],[1,"bi","bi-arrow-left","fs-4"],[1,"mb-0","fw-bold","text-gradient"],["class","alert alert-warning glass-card border-warning text-warning mb-4",4,"ngIf"],["class","row justify-content-center",4,"ngIf"],[1,"alert","alert-warning","glass-card","border-warning","text-warning","mb-4"],[1,"d-flex"],[1,"bi","bi-exclamation-triangle-fill","me-3","fs-4"],[1,"alert-heading","fw-bold"],[1,"mb-3","small"],["routerLink","/set-income",1,"btn","btn-sm","btn-warning","text-dark","fw-bold"],[1,"row","justify-content-center"],[1,"col-12","col-lg-8"],["novalidate","",1,"glass-card","p-4",3,"ngSubmit","formGroup"],[1,"mb-4"],["for","title",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],[1,"input-group"],[1,"input-group-text","bg-transparent","border-end-0","text-accent"],[1,"bi","bi-type"],["type","text","id","title","formControlName","title","placeholder","What did you buy?",1,"form-control","form-control-lg","bg-transparent","text-white","border-start-0","ps-0"],["class","text-danger small mt-1",4,"ngIf"],[1,"row"],[1,"col-md-6","mb-4"],["for","amount",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],[1,"fw-bold"],["type","number","id","amount","formControlName","amount","min","0.01","step","0.01","placeholder","0.00",1,"form-control","form-control-lg","bg-transparent","text-white","border-start-0","ps-0"],["for","date",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],[1,"bi","bi-calendar-event"],["type","date","id","date","formControlName","date",1,"form-control","form-control-lg","bg-transparent","text-white","border-start-0","ps-0"],["for","category",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],[1,"bi","bi-tag"],["id","category","formControlName","category",1,"form-select","form-select-lg","bg-transparent","text-white","border-start-0","ps-0"],["value","","disabled","","selected",""],["class","text-dark",3,"value",4,"ngFor","ngForOf"],["for","paymentMethod",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],[1,"bi","bi-credit-card"],["id","paymentMethod","formControlName","paymentMethod",1,"form-select","form-select-lg","bg-transparent","text-white","border-start-0","ps-0"],["for","tags",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],[1,"bi","bi-hash"],["type","text","id","tags","formControlName","tags","placeholder","business, urgent, etc.",1,"form-control","bg-transparent","text-white","border-start-0","ps-0"],[1,"mb-5"],["for","notes",1,"form-label","text-secondary","small","text-uppercase","fw-bold"],["id","notes","formControlName","notes","rows","3","placeholder","Add any additional details...",1,"form-control","bg-transparent","text-white"],[1,"d-grid"],["type","submit",1,"btn","btn-primary-gradient","btn-lg","rounded-pill","py-3","fw-bold",3,"disabled"],[1,"glass-card","mt-4","p-3"],[1,"text-white","mb-3"],[1,"d-flex","justify-content-between","mb-2"],[1,"text-secondary"],[1,"text-white"],[1,"progress","bg-dark",2,"height","6px"],["role","progressbar",1,"progress-bar",3,"ngClass"],[1,"text-danger","small","mt-1"],[1,"text-dark",3,"value"]],template:function(i,l){i&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),c(3,"i",3),e(),t(4,"h2",4),r(5,"Add Expense"),e()(),p(6,re,10,0,"div",5)(7,ce,76,19,"div",6),e()),i&2&&(d(6),m("ngIf",!l.hasMonthlyIncome),d(),m("ngIf",l.hasMonthlyIncome))},dependencies:[T,P,A,N,Z,K,H,J,U,L,z,G,$,Q,Y,W,V,B,k],styles:[".form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.1);color:#fff}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{background:#ffffff1a;border-color:var(--text-accent);box-shadow:0 0 0 4px #6366f11a;color:#fff}.form-control[_ngcontent-%COMP%]::placeholder, .form-select[_ngcontent-%COMP%]::placeholder{color:#ffffff4d}.input-group-text[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.1);border-right:none}.form-control[_ngcontent-%COMP%]:focus + .input-group-text[_ngcontent-%COMP%], .form-control[_ngcontent-%COMP%]:focus ~ .input-group-text[_ngcontent-%COMP%]{border-color:var(--text-accent)}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{background-color:#1e293b;color:#fff;padding:10px}input[type=date][_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{filter:invert(1);opacity:.6;cursor:pointer}input[type=date][_ngcontent-%COMP%]::-webkit-calendar-picker-indicator:hover{opacity:1}.btn-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;border-radius:50%;background:#ffffff0d;transition:all .2s}.btn-icon[_ngcontent-%COMP%]:hover{background:#ffffff1a;transform:translate(-2px)}"]})};export{te as AddExpense};
