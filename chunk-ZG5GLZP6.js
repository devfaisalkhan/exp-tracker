import{P as d,a as u,b as i}from"./chunk-SNEZJZPV.js";var a=class{static KEY_BUDGETS="budgets";static KEY_EXPENSES="expenses";static KEY_INCOME="monthlyIncome"};var h=class m{expensesStorageKey="expenses";constructor(){}loadMonthlyIncome(){let e=localStorage.getItem(a.KEY_INCOME);return e?JSON.parse(e).map(n=>i(u({},n),{createdAt:new Date(n.createdAt),updatedAt:new Date(n.updatedAt)})):[]}saveMonthlyIncome(e){localStorage.setItem(a.KEY_INCOME,JSON.stringify(e))}getMonthlyIncome(e,t){let n=this.loadMonthlyIncome(),o=`${e}-${t.toString().padStart(2,"0")}`;return n.find(r=>r.id===o)}setMonthlyIncome(e,t,n){let o=this.loadMonthlyIncome(),r=`${e}-${t.toString().padStart(2,"0")}`,s=new Date,c=o.findIndex(l=>l.id===r);if(c!==-1)o[c]=i(u({},o[c]),{amount:n,updatedAt:s});else{let l={id:r,amount:n,currency:"PKR",createdAt:s,updatedAt:s};o.push(l)}return this.saveMonthlyIncome(o),o[c!==-1?c:o.length-1]}deleteMonthlyIncome(e,t){let n=this.loadMonthlyIncome(),o=`${e}-${t.toString().padStart(2,"0")}`,r=n.findIndex(s=>s.id===o);return r!==-1?(n.splice(r,1),this.saveMonthlyIncome(n),!0):!1}getMonthlyExpenses(e,t){let n=localStorage.getItem(a.KEY_EXPENSES);return n?JSON.parse(n).map(r=>i(u({},r),{date:new Date(r.date),createdAt:new Date(r.createdAt),updatedAt:new Date(r.updatedAt)})).filter(r=>{let s=new Date(r.date);return s.getFullYear()===e&&s.getMonth()+1===t}):[]}getMonthlySpent(e,t){return this.getMonthlyExpenses(e,t).reduce((o,r)=>o+r.amount,0)}getRemainingBudget(e,t){let n=this.getMonthlyIncome(e,t);if(!n)return 0;let o=this.getMonthlySpent(e,t);return n.amount-o}getPercentageUsed(e,t){let n=this.getMonthlyIncome(e,t);if(!n||n.amount===0)return 0;let o=this.getMonthlySpent(e,t);return Math.min(100,o/n.amount*100)}isOverBudget(e,t){return this.getRemainingBudget(e,t)<0}getAllMonthlyIncomes(){return this.loadMonthlyIncome()}wouldExceedBudget(e,t,n){let o=this.getMonthlyIncome(e,t);if(!o)return{exceeds:!1,excessAmount:0};let s=this.getMonthlySpent(e,t)+n,c=s-o.amount;return{exceeds:s>o.amount,excessAmount:Math.max(0,c)}}formatMonthKey(e,t){return`${e}-${t.toString().padStart(2,"0")}`}static \u0275fac=function(t){return new(t||m)};static \u0275prov=d({token:m,factory:m.\u0275fac,providedIn:"root"})};export{a,h as b};
