import{a as R,b as L,c as j,d as F,e as Y,f as N,g as W,h as z,i as H,j as K,k as $,l as V,m as q}from"./chunk-2AEC5X7M.js";import{f as U,j as A}from"./chunk-XBZE7J4I.js";import{a as J}from"./chunk-BSCQJHQY.js";import{b as G}from"./chunk-HU6D55GF.js";import"./chunk-VSDMO5SJ.js";import{i as I,j as k,k as O,p as B,q as P,r as _,s as T}from"./chunk-ZTY7VYUY.js";import{Aa as r,Ab as x,Ga as u,Gb as E,Hb as d,Jb as s,Kb as M,Ma as C,Ra as f,Tb as D,ab as S,bb as g,cb as t,db as n,eb as c,vb as w,wb as v,xb as i,yb as p,zb as h}from"./chunk-I6MSPIIX.js";var Z=(m,a,o)=>({"bg-gradient-success":m,"bg-gradient-warning":a,"bg-gradient-danger":o});function ee(m,a){if(m&1&&(t(0,"div",53)(1,"div",54)(2,"div",55),c(3,"i",56),n(),t(4,"div",57)(5,"h6",48),i(6),n(),t(7,"small",18),i(8),d(9,"date"),n()(),t(10,"div",13)(11,"h6",48),i(12),d(13,"number"),n()()()()),m&2){let o=a.$implicit;r(6),p(o.title),r(2),x("",s(9,4,o.date,"MMM d, y")," \u2022 ",o.category),r(4),h("- ",s(13,7,o.amount,"1.0-0"))}}function te(m,a){m&1&&(t(0,"div",58)(1,"p",3),i(2,"No transactions yet"),n()())}F.register(j,R,L,$,V,W,N,H,K,z,Y);var Q=class m{constructor(a,o,e){this.expenseService=a;this.incomeService=o;this.cdr=e}expenses=[];totalExpenses=0;totalAmount=0;weeklyExpenses=[];categorySummaries=[];currentMonthIncome=null;currentMonthSpent=0;remainingBudget=0;percentageUsed=0;isOverBudget=!1;weeklyChartType="line";categoryChartType="doughnut";budgetChartType="doughnut";weeklyChartData={labels:[],datasets:[{data:[],label:"Amount (PKR)",borderColor:"#818cf8",backgroundColor:"rgba(129, 140, 248, 0.2)",pointBackgroundColor:"#818cf8",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"#818cf8",fill:!0,tension:.4}]};categoryChartData={labels:[],datasets:[{data:[],backgroundColor:["#6366f1","#8b5cf6","#d946ef","#ec4899","#f43f5e","#f97316","#eab308","#84cc16","#10b981","#06b6d4","#3b82f6","#64748b"],borderWidth:0,hoverOffset:4}]};monthlyBudgetChartData={labels:[],datasets:[{data:[],backgroundColor:["#3b82f6","#10b981"],borderWidth:0}]};chartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#94a3b8",font:{family:"Inter"}}}},scales:{x:{ticks:{color:"#94a3b8"},grid:{color:"rgba(255, 255, 255, 0.05)"}},y:{ticks:{color:"#94a3b8"},grid:{color:"rgba(255, 255, 255, 0.05)"}}}};currentYear=new Date().getFullYear();currentMonth=new Date().getMonth()+1;currentDate=new Date;Math=Math;ngOnInit(){this.loadDashboardData()}loadDashboardData(){this.expenseService.expenses$.subscribe(a=>{this.expenses=a,this.loadIncomeData(),this.calculateDashboardStats(),this.updateCharts(),this.cdr.markForCheck()})}loadIncomeData(){let a=this.incomeService.getMonthlyIncome(this.currentYear,this.currentMonth);this.currentMonthIncome=a?a.amount:null,this.currentMonthSpent=this.expenseService.getMonthlySpent(this.currentYear,this.currentMonth),this.remainingBudget=this.incomeService.getRemainingBudget(this.currentYear,this.currentMonth),this.percentageUsed=this.incomeService.getPercentageUsed(this.currentYear,this.currentMonth),this.isOverBudget=this.incomeService.isOverBudget(this.currentYear,this.currentMonth)}calculateDashboardStats(){this.totalExpenses=this.expenses.length,this.totalAmount=this.expenses.reduce((e,l)=>e+l.amount,0),this.weeklyExpenses=[];let a=new Date;for(let e=6;e>=0;e--){let l=new Date(a);l.setDate(a.getDate()-e);let X=this.expenses.filter(b=>new Date(b.date).toDateString()===l.toDateString()).reduce((b,y)=>b+y.amount,0);this.weeklyExpenses.push({day:l.toLocaleDateString("en-US",{weekday:"short"}),amount:X})}let o=new Map;this.expenses.forEach(e=>{o.has(e.category)||o.set(e.category,{total:0,count:0});let l=o.get(e.category);l.total+=e.amount,l.count+=1}),this.categorySummaries=Array.from(o.entries()).map(([e,l])=>({category:e,total:l.total,count:l.count})).sort((e,l)=>l.total-e.total)}updateCharts(){this.weeklyChartData.labels=this.weeklyExpenses.map(a=>a.day),this.weeklyChartData.datasets[0].data=this.weeklyExpenses.map(a=>a.amount),this.categoryChartData.labels=this.categorySummaries.map(a=>a.category),this.categoryChartData.datasets[0].data=this.categorySummaries.map(a=>a.total),this.currentMonthIncome!==null?(this.monthlyBudgetChartData.labels=["Spent","Remaining"],this.monthlyBudgetChartData.datasets[0].data=[this.currentMonthSpent,Math.max(0,this.currentMonthIncome-this.currentMonthSpent)],this.monthlyBudgetChartData.datasets[0].backgroundColor=[this.isOverBudget?"#ef4444":"#3b82f6",this.isOverBudget?"#f59e0b":"#10b981"]):(this.monthlyBudgetChartData.labels=["No Income Set"],this.monthlyBudgetChartData.datasets[0].data=[1],this.monthlyBudgetChartData.datasets[0].backgroundColor=["#475569"])}getTopCategory(){return this.categorySummaries.length>0?this.categorySummaries[0]:null}static \u0275fac=function(o){return new(o||m)(u(G),u(J),u(D))};static \u0275cmp=C({type:m,selectors:[["app-dashboard"]],decls:117,vars:65,consts:[[1,"container-fluid","dashboard-container"],[1,"dashboard-header","mb-4","d-flex","justify-content-between","align-items-center"],[1,"mb-0","fw-bold","text-gradient"],[1,"text-secondary","mb-0"],[1,"d-flex","gap-2"],["routerLink","/set-income",1,"btn","btn-outline-light","btn-sm","rounded-pill","px-3"],[1,"bi","bi-wallet2","me-2"],[1,"row","mb-4"],[1,"col-12"],[1,"glass-card"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"text-white","mb-1"],[1,"text-secondary","mb-0","small"],[1,"text-end"],[1,"mb-0","fw-bold"],[1,"fs-6","text-secondary"],[1,"mb-4"],[1,"d-flex","justify-content-between","mb-2"],[1,"text-secondary"],[1,"progress","bg-dark",2,"height","8px","border-radius","4px"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",3,"ngClass"],[1,"row","g-3"],[1,"col-4"],[1,"p-3","rounded-3","bg-white-5","text-center"],[1,"d-block","text-secondary","mb-1"],[1,"fw-bold","text-white"],[1,"fw-bold"],[1,"row","g-3","mb-4"],[1,"col-6","col-md-3"],[1,"glass-card","h-100","p-3","text-center"],[1,"icon-box","bg-primary-gradient","mb-3","mx-auto"],[1,"bi","bi-receipt","text-white","fs-5"],[1,"fw-bold","text-white","mb-0"],[1,"icon-box","bg-success-gradient","mb-3","mx-auto"],[1,"bi","bi-cash-stack","text-white","fs-5"],[1,"icon-box","bg-info-gradient","mb-3","mx-auto"],[1,"bi","bi-tag","text-white","fs-5"],[1,"fw-bold","text-white","mb-0","text-truncate"],[1,"icon-box","bg-warning-gradient","mb-3","mx-auto"],[1,"bi","bi-graph-up","text-white","fs-5"],[1,"row","g-4","mb-4"],[1,"col-12","col-lg-8"],[1,"glass-card","h-100"],[1,"text-white","mb-4"],[1,"chart-container",2,"height","250px"],["baseChart","",3,"data","options","type"],[1,"col-12","col-lg-4"],[1,"glass-card","mb-5"],[1,"text-white","mb-0"],["routerLink","/expenses",1,"btn","btn-link","text-accent","text-decoration-none","p-0"],[1,"list-group","list-group-flush","bg-transparent"],["class","list-group-item bg-transparent border-bottom border-white-10 px-0 py-3",4,"ngFor","ngForOf"],["class","text-center py-4",4,"ngIf"],[1,"list-group-item","bg-transparent","border-bottom","border-white-10","px-0","py-3"],[1,"d-flex","align-items-center"],[1,"icon-circle","bg-white-5","me-3","text-accent"],[1,"bi","bi-bag"],[1,"flex-grow-1"],[1,"text-center","py-4"]],template:function(o,e){if(o&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),i(4,"Dashboard"),n(),t(5,"p",3),i(6,"Welcome back to your financial overview"),n()(),t(7,"div",4)(8,"a",5),c(9,"i",6),i(10,"Set Income "),n()()(),t(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"div")(16,"h5",11),i(17,"Monthly Budget"),n(),t(18,"p",12),i(19),d(20,"date"),n()(),t(21,"div",13)(22,"h3",14),i(23),d(24,"number"),t(25,"small",15),i(26,"PKR left"),n()()()(),t(27,"div",16)(28,"div",17)(29,"small",18),i(30),d(31,"number"),n(),t(32,"small",18),i(33),d(34,"number"),n()(),t(35,"div",19),c(36,"div",20),n()(),t(37,"div",21)(38,"div",22)(39,"div",23)(40,"small",24),i(41,"Income"),n(),t(42,"span",25),i(43),d(44,"number"),n()()(),t(45,"div",22)(46,"div",23)(47,"small",24),i(48,"Spent"),n(),t(49,"span",25),i(50),d(51,"number"),n()()(),t(52,"div",22)(53,"div",23)(54,"small",24),i(55,"Used"),n(),t(56,"span",26),i(57),d(58,"number"),n()()()()()()(),t(59,"div",27)(60,"div",28)(61,"div",29)(62,"div",30),c(63,"i",31),n(),t(64,"h3",32),i(65),n(),t(66,"small",18),i(67,"Total Transactions"),n()()(),t(68,"div",28)(69,"div",29)(70,"div",33),c(71,"i",34),n(),t(72,"h3",32),i(73),d(74,"number"),n(),t(75,"small",18),i(76,"Total Spent"),n()()(),t(77,"div",28)(78,"div",29)(79,"div",35),c(80,"i",36),n(),t(81,"h5",37),i(82),n(),t(83,"small",18),i(84,"Top Category"),n()()(),t(85,"div",28)(86,"div",29)(87,"div",38),c(88,"i",39),n(),t(89,"h3",32),i(90),d(91,"number"),n(),t(92,"small",18),i(93,"Avg. per Txn"),n()()()(),t(94,"div",40)(95,"div",41)(96,"div",42)(97,"h5",43),i(98,"Weekly Activity"),n(),t(99,"div",44),c(100,"canvas",45),n()()(),t(101,"div",46)(102,"div",42)(103,"h5",43),i(104,"Spending by Category"),n(),t(105,"div",44),c(106,"canvas",45),n()()()(),t(107,"div",47)(108,"div",10)(109,"h5",48),i(110,"Recent Transactions"),n(),t(111,"a",49),i(112,"View All"),n()(),t(113,"div",50),f(114,ee,14,10,"div",51),d(115,"slice"),f(116,te,3,0,"div",52),n()()()),o&2){let l;r(19),x("",e.currentYear," - ",s(20,30,e.currentDate,"MMMM")),r(3),v("text-danger",e.isOverBudget)("text-success",!e.isOverBudget),r(),h(" ",s(24,33,e.remainingBudget,"1.0-0")," "),r(7),h("Spent: ",s(31,36,e.currentMonthSpent,"1.0-0")),r(3),h("Limit: ",s(34,39,e.currentMonthIncome,"1.0-0")),r(3),w("width",e.Math.min(100,e.percentageUsed),"%"),g("ngClass",E(61,Z,e.percentageUsed<80,e.percentageUsed>=80&&e.percentageUsed<=100,e.percentageUsed>100)),S("aria-valuenow",e.percentageUsed),r(7),p(e.currentMonthIncome!==null?s(44,42,e.currentMonthIncome,"1.0-0"):"-"),r(7),p(s(51,45,e.currentMonthSpent,"1.0-0")),r(6),v("text-danger",e.percentageUsed>100),r(),h("",s(58,48,e.percentageUsed,"1.0-0"),"%"),r(8),p(e.totalExpenses),r(8),p(s(74,51,e.totalAmount,"1.0-0")),r(9),p(((l=e.getTopCategory())==null?null:l.category)||"-"),r(8),p(e.totalExpenses>0?s(91,54,e.totalAmount/e.totalExpenses,"1.0-0"):"0"),r(10),g("data",e.weeklyChartData)("options",e.chartOptions)("type",e.weeklyChartType),r(6),g("data",e.categoryChartData)("options",e.chartOptions)("type",e.categoryChartType),r(8),g("ngForOf",M(115,57,e.expenses,0,5)),r(2),g("ngIf",e.expenses.length===0)}},dependencies:[T,I,k,O,A,U,q,_,P,B],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px 16px 80px}.icon-box[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center}.icon-circle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center}.bg-white-5[_ngcontent-%COMP%]{background:#ffffff0d}.bg-white-10[_ngcontent-%COMP%]{background:#ffffff1a}.border-white-10[_ngcontent-%COMP%]{border-color:#ffffff1a!important}.text-accent[_ngcontent-%COMP%]{color:var(--text-accent)!important}.bg-primary-gradient[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6366f1,#8b5cf6)}.bg-success-gradient[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.bg-info-gradient[_ngcontent-%COMP%]{background:linear-gradient(135deg,#06b6d4,#3b82f6)}.bg-warning-gradient[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f59e0b,#d97706)}.bg-gradient-success[_ngcontent-%COMP%]{background:linear-gradient(90deg,#10b981,#34d399)}.bg-gradient-warning[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f59e0b,#fbbf24)}.bg-gradient-danger[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ef4444,#f87171)}.fab-container[_ngcontent-%COMP%]{position:fixed;bottom:90px;right:24px;z-index:1000}.fab-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.175,.885,.32,1.275)}.fab-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{transform:scale(1.1) rotate(90deg);box-shadow:0 10px 25px #6366f180!important}.fab-container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active{transform:scale(.95)}@media (min-width: 769px){.fab-container[_ngcontent-%COMP%]{bottom:40px;right:40px}.dashboard-container[_ngcontent-%COMP%]{padding:32px}}"]})};export{Q as DashboardComponent};
